
process laserAlignment = {
    
    service = MessageLogger {
	// Specify two output Log-files
	untracked vstring destinations = {
	    "cout", 
	    "cerr"
	}
	
	// Define their policy
	untracked PSet cout = { untracked string threshold = "INFO"  }
	untracked PSet cerr = { untracked string threshold = "ERROR" }
	untracked vstring debugModules = {  "LaserAlignment"  } 
    }  

    include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"

    // tracker input geometry
    include "CondCore/DBCommon/data/CondDBSetup.cfi"

    // all records
    es_source allSource = PoolDBESSource {
	using CondDBSetup
	string connect = "frontier://FrontierProd/CMS_COND_20X_GLOBALTAG"
	string globaltag = "IDEAL_v2::All"
    }

    // get the tracker alignment records from this file:
    es_source alignmentSource = PoolDBESSource {
	using CondDBSetup
	//string connect = "sqlite_file:/afs/cern.ch/user/o/olzem/scratch0/cms/las/db/TrackerNoKnowledgeScenario.db"
	string connect = "sqlite_file:/afs/cern.ch/user/o/olzem/cms/cmssw/CMSSW_2_2_0/src/Alignment/LaserAlignment/test/Alignments_S.db"
	string timetype = "runnumber"
	VPSet toGet = { 
	    { string record = "TrackerAlignmentRcd"  string tag = "Alignments" },
	    { string record = "TrackerAlignmentErrorRcd" string tag = "AlignmentErrors" }
	}
    } 
    
    // prefer the alignment record
    es_prefer alignmentSource = PoolDBESSource{}

    include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi" # conf. TrackerDigiGeometryESModule
    replace TrackerDigiGeometryESModule.applyAlignment = true

    include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
        

   # -- DB STUFF
   # pedestals service
#   es_source siStripPedestals = poolDBESSource from "CalibTracker/Configuration/data/Common/PoolDBESSource.cfi"
#   replace siStripPedestals.connect="frontier://Frontier/CMS_COND_STRIP"
#   replace siStripPedestals.toGet = {{ string record = "SiStripPedestalsRcd"
#                                       string tag = "SiStripPedestals_TIF_20X" }}

   # alignment output
   include "CondCore/DBCommon/data/CondDBCommon.cfi"
   replace CondDBCommon.connect = "sqlite_file:Alignments.db"
   ## replace CondDBCommon.catalog = "file:condbcatalog.xml"

   // Database output service
   service = PoolDBOutputService {
     using CondDBCommon
     VPSet toPut = {
       { string record = "TrackerAlignmentRcd"
         string tag = "Alignments" },
       { string record = "TrackerAlignmentErrorRcd"
         string tag = "AlignmentErrors" }
     }
   } 
    

    # Sources
    source = PoolSource {
        untracked vstring fileNames = { 
            # CSA08 POST-PRODUCTION
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/0A045025-DC5C-DD11-BACC-001E0B477F28.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/0C24CE61-DC5C-DD11-A849-001E0B479F9C.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/0ED0A72F-DC5C-DD11-A382-001F29C49310.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/1615BCCE-DB5C-DD11-A1FB-001E0B48D104.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/261A6565-DC5C-DD11-9162-001E0B5F68AA.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/34328589-DB5C-DD11-893B-0018FE290052.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/4AC4F4D0-DB5C-DD11-A00D-001E0B5F68AA.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/88818224-DC5C-DD11-B625-001E0B48D104.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/8AF6D667-DC5C-DD11-B8C2-001F296A7696.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/9EA95865-DC5C-DD11-95AF-001F29C450E2.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/C23D6735-DC5C-DD11-BA1B-001F296BD566.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0053/FEBDBFDF-DB5C-DD11-8B68-001CC443B7B8.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/08225C59-DF5C-DD11-9C1C-001F29C4D344.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/10D231C3-DD5C-DD11-A38C-001F29C4A3A2.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/18D4FE5D-DF5C-DD11-8659-0018FE28BF02.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/34C872C7-DD5C-DD11-9021-0018FE2940F4.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/4A2C7553-DF5C-DD11-AE40-0018FE286D76.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/52E75EC6-DD5C-DD11-9050-001E0B476FA2.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/761362C8-DD5C-DD11-8DBA-001F29C4A30E.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/BE54F252-DF5C-DD11-9948-0018FE28BF24.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/E22E9BC6-DD5C-DD11-948C-001F296A52A4.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/F817D8D2-E05C-DD11-B2F2-0018FE28BEB8.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/F8FF6F59-DF5C-DD11-B93F-001E0B5FA53A.root",
	    "/store/mc/Summer08/TrackerLaser/ALCARECO/IDEAL_V2_TkAlLAS_v1/0054/FCD96445-DF5C-DD11-AE4B-001E0B48610E.root"
# PRIVATE PRODUCTION FILES
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_0.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_1.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_2.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_3.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_4.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_5.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_6.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_7.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_8.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_9.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_10.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_11.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_12.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_13.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_14.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_15.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_16.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_17.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_18.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_19.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_20.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_21.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_22.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_23.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_24.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_25.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_26.root", 
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_27.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_28.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_29.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_30.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_31.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_32.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_33.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_34.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_35.root",
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_36.root", 
#	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_37.root"
	}
    }
    # End Sources  

    # End Modules
    #=========================================================================================


    # LaserAlignment module
    include "Alignment/LaserAlignment/data/LaserAlignment.cfi"
    replace LaserAlignment.NumberOfEventsPerLaserIntensity = 1
    replace LaserAlignment.NumberOfEventsForAllIntensities = 1
    replace LaserAlignment.DigiProducersList = {
      { string DigiProducer = "laserAlignmentT0Producer"
	string DigiLabel    = "VirginRaw" }
    }
    replace LaserAlignment.saveToDbase = true
    replace LaserAlignment.saveHistograms = true
    replace LaserAlignment.SubtractPedestals = false
    replace LaserAlignment.UpdateFromIdealGeometry = true
    replace LaserAlignment.UseNewAlgorithms = true
    # replace LaserAlignment.UseBrunosAlignmentAlgorithm = true # effective only if NOT UseNewAlgorithms
    replace LaserAlignment.EnableJudgeZeroFilter = false # for MC

    untracked PSet maxEvents = { untracked int32 input = 50 }

    module dump = EventContentAnalyzer {}	
    sequence alignment = { LaserAlignment }#, dump }

    path laser = { alignment }

    # End Schedule
    #=========================================================================================
}

