
process laserAlignment = {
    
    service = MessageLogger {
	// Specify two output Log-files
	untracked vstring destinations = {
	    "cout", 
	    "cerr"
	}
	
	// Define their policy
	untracked PSet cout = { untracked string threshold = "INFO"  }
	untracked PSet cerr = { untracked string threshold = "ERROR" }
	untracked vstring debugModules = {  "LaserAlignment"  } 
    }  

    include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"

    // tracker input geometry
    include "CondCore/DBCommon/data/CondDBSetup.cfi"

    // all records
    es_source allSource = PoolDBESSource {
	using CondDBSetup
	string connect = "frontier://FrontierProd/CMS_COND_20X_GLOBALTAG"
	untracked string globaltag = "IDEAL_v2::All"
    }

    // get the tracker alignment records from this file:
    es_source alignmentSource = PoolDBESSource {
	using CondDBSetup
	//string connect = "sqlite_file:/afs/cern.ch/user/o/olzem/scratch0/cms/las/db/TrackerNoKnowledgeScenario.db"
	string connect = "sqlite_file:/afs/cern.ch/user/o/olzem/cms/cmssw/CMSSW_2_1_0_pre5/src/Alignment/LaserAlignment/test/Alignments_S.db"
	string timetype = "runnumber"
	VPSet toGet = { 
	    { string record = "TrackerAlignmentRcd"  string tag = "Alignments" },
	    { string record = "TrackerAlignmentErrorRcd" string tag = "AlignmentErrors" }
	}
    } 
    
    // prefer the alignment record
    es_prefer alignmentSource = PoolDBESSource{}

    include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi" # conf. TrackerDigiGeometryESModule
    replace TrackerDigiGeometryESModule.applyAlignment = true

    include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
        

   # -- DB STUFF
   # pedestals service
#   es_source siStripPedestals = poolDBESSource from "CalibTracker/Configuration/data/Common/PoolDBESSource.cfi"
#   replace siStripPedestals.connect="frontier://Frontier/CMS_COND_STRIP"
#   replace siStripPedestals.toGet = {{ string record = "SiStripPedestalsRcd"
#                                       string tag = "SiStripPedestals_TIF_20X" }}

   # alignment output
   include "CondCore/DBCommon/data/CondDBCommon.cfi"
   replace CondDBCommon.connect = "sqlite_file:Alignments.db"
   ## replace CondDBCommon.catalog = "file:condbcatalog.xml"

   // Database output service
   service = PoolDBOutputService {
     using CondDBCommon
     VPSet toPut = {
       { string record = "TrackerAlignmentRcd"
         string tag = "Alignments" },
       { string record = "TrackerAlignmentErrorRcd"
         string tag = "AlignmentErrors" }
     }
   } 
    

    # Sources
    source = PoolSource {
        untracked vstring fileNames = { 
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_0.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_1.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_2.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_3.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_4.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_5.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_6.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_7.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_8.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_9.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_10.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_11.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_12.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_13.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_14.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_15.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_16.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_17.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_18.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_19.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_20.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_21.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_22.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_23.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_24.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_25.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_26.root", 
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_27.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_28.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_29.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_30.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_31.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_32.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_33.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_34.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_35.root",
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_36.root", 
	    "file:/afs/cern.ch/user/o/olzem/cms/las/csa08/privateProduction/step2/nt/TkAlLAS_37.root"
	}
    }
    # End Sources  

    # End Modules
    #=========================================================================================


    # LaserAlignment module
    include "Alignment/LaserAlignment/data/LaserAlignment.cfi"
    replace LaserAlignment.NumberOfEventsPerLaserIntensity = 1
    replace LaserAlignment.NumberOfEventsForAllIntensities = 1
    replace LaserAlignment.DigiProducersList = {
      { string DigiProducer = "laserAlignmentT0Producer"
	string DigiLabel    = "VirginRaw" }
    }
    replace LaserAlignment.saveToDbase = true
    replace LaserAlignment.saveHistograms = true
    replace LaserAlignment.SubtractPedestals = false
    replace LaserAlignment.UpdateFromIdealGeometry = true
    replace LaserAlignment.UseNewAlgorithms = true
    # replace LaserAlignment.UseBrunosAlignmentAlgorithm = true # effective only if NOT UseNewAlgorithms
    replace LaserAlignment.EnableJudgeZeroFilter = false # for MC

    untracked PSet maxEvents = { untracked int32 input = 200 }

    module dump = EventContentAnalyzer {}	
    sequence alignment = { LaserAlignment }#, dump }

    path laser = { alignment }

    # End Schedule
    #=========================================================================================
}

